# 商品データ移行プロジェクト

## 概要
- 商品データ移行プロジェクト
  - 商品分類のデータ保持方法を変更するため、140 万件の商品データを移行
  - データを正規化して複数テーブルに分割
  - テキストで保存されている商品のカテゴリを階層化
  - Sppring Batch を使用して移行バッチを作成

## 詳細
- Spring Batch のキャッチアップ
- 移行処理の設計
- 移行元・移行先のテーブルを用意
- TSV ファイルを DB のテーブルにロード
- 移行元テーブルから商品カテゴリを個別に抽出して移行
- 移行元テーブルから商品データを移行
- データの整合性をチェックし、移行できないデータをファイルに書き出し
- データ移行実施

 <!-- ![マークダウンサンプル] -->
 <!-- HTMLでの記法でサイズ、位置などが変更できる-->
<p align="center">
  <img width="70%" src="migration.png">
</p><br>

### 1.Spring Batch のキャッチアップ
[旧商品データ]テーブルから[新商品データ]テーブル、[カテゴリーデータ]テーブルにデータを移行するため、Spring Batch を使用して移行バッチを作成する。Spring Batch はバッチ処理を行うためのフレームワークであり、バッチ処理で必要になる多くの機能を提供しているためそれを利用する。インターネット等で情報を収集し、Spring Batch の使い方を把握する

### 2.移行処理の設計
移行処理フローの概要は以下の通りである
1. 移行元テーブルから商品カテゴリを個別に抽出して移行（[カテゴリーデータ]テーブルのデータ生成）
2. 移行元テーブルから商品データを移行（[新商品データ]テーブルのデータ生成）

上記の処理をSpring Batchを使用して実装する前に、クラス図とシーケンス図を作成する。クラス図、シーケン図ともにツールはmarmaidを使用する。（marmaidの使い方等についてもインターネット等で学習する）

移行の処理については、[別途要件](./docs/requirements/README.md)が定められているため、そちらを加味した上で設計する


### 3.移行元・移行先のテーブルを用意
移行元テーブル：[旧商品データ]テーブル
移行先テーブル：[新商品データ]テーブル、[カテゴリーデータ]テーブル

上述した[別途要件](./docs/feature/create_category/README.md)の中で、各テーブルの定義が定められているので、それに従ってテーブルを作成する

### TSVファイルをDBのテーブルにロード
[旧商品データ]デーブル用のデータがTSVファイルで提供されているので、それをDBのテーブルにロードする。ロードの仕方をインターネット等で調査し実施する
